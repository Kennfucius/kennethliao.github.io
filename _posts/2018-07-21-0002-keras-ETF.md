---
title: "Stock Market Forecasting With a Simple Neural Network"
date: 2018-07-21
tags: [regression, analysis, neural network, stock market]
header:
  overlay_image: "/images/0002-keras-ETF/0002-banner1-small.jpg"
  overlay_filter: 0.5
  teaser: "/images/0002-keras-ETF/0002-banner3.jpg"
excerpt: "Forecasting U.S. Sector ETFs using economic indicators"
mathjax: "true"
# This sets the table of contents on the right of the page
toc: true
toc_label: "Table of Contents"
toc_icon: "trending_up"
toc_sticky: "true"
---

## Objective
I created a simple neural network (NN) using the [Keras](https://keras.io/) python library. The NN was trained to predict future exchange traded fund (ETF) prices based on economic indicators.

## Background

> Note: All visualizations are interactive and were generated using [plotly](https://plot.ly/python/). Plotted data can be controlled by selecting or unselecting items in the legend.

### Data

#### Figure 1 | Sector ETF Time Series
![Sector ETF Time Series](https://github.com/Kennfucius/kennfucius.github.io/blob/master/images/0002-keras-ETF/sectorETFs.html)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Data for six U.S. sector ETFs was obtained from yahoo finance. The data spans May 2000 to September 2017 and the period is 1 week. Sector ETFs tend to experience significantly less volatility than their individual underlying assets. This makes them attractive for forecasting. Figure 1 shows the time series plots for all six sector ETFs.

1. Technology ([IYW](https://finance.yahoo.com/quote/IYW))
2. Basic Materials ([IYM](https://finance.yahoo.com/quote/IYM))
3. Consumer Goods ([IYK](https://finance.yahoo.com/quote/IYK))
4. Services ([IYC](https://finance.yahoo.com/quote/IYC))
5. Healthcare ([IYH](https://finance.yahoo.com/quote/IYH))
6. Utilities ([IDU](https://finance.yahoo.com/quote/IDU))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

> Note:

#### Figure 2 | Indicators
<div>
    <a href="https://plot.ly/~Kennfucius/78/?share_key=xHLP4d38HdhbnJi2GFYn0d" target="_blank" title="indicators" style="display: block; text-align: center;"><img src="https://plot.ly/~Kennfucius/78.png?share_key=xHLP4d38HdhbnJi2GFYn0d" alt="indicators" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="Kennfucius:78" sharekey-plotly="xHLP4d38HdhbnJi2GFYn0d" src="https://plot.ly/embed.js" async></script>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The raw values for the 10 economic indicators used to train the model are shown in Figure 2; to resolve all indicators, data can be filtered by selecting or unselecting items in the figure legend. See the expandable list below for descriptions of each indicator.

<details>
  <summary>Expand for a list of the economic indicators used. </summary><p>
    <table style="width:100%"><tr><th>Indicator</th><th>Description</th></tr>
    <tr><td>HOUST</td><td>Housing Starts: Total: New Privately Owned Housing Units Started</td></tr>
    <tr><td>UNRATENSA</td><td>Civilian Unemployment Rate NSA</td></tr>
    <tr><td>EMRATIO</td><td>Civilian Employment-Population Ratio</td></tr>
    <tr><td>UEMPMED</td><td>Median Duration of Unemployment</td></tr>
    <tr><td>UMCSENT</td><td>University of Michigan: Consumer Sentiment</td></tr>
    <tr><td>USSLIND</td><td>Leading Index for the United States</td></tr>
    <tr><td>KCFSI</td><td>Kansas City Financial Stress Index</td></tr>
    <tr><td>IPMAN</td><td>Industrial Production: Manufacturing (NAICS)</td></tr>
    <tr><td>VIXCLS</td><td>CBOE Volatility Index: NSA</td></tr>
    <tr><td>DGS10</td><td>10-Year Treasury Constant Maturity Rate</td></tr></table>
</p></details>
<br>
### Model
#### Figure 3 | Diagram of NN Model
![NN Model]({{ "/images/0002-keras-ETF/nn-model.png" | absolute_url }})

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Figure 3 shows the NN model diagram. The model is about as simple as you can get with a single hidden layer. The input layer contains 10 neurons corresponding to the 10 economic indicators. The hidden layer contains 20 neurons and output layer 6. The NN is fully connected which means that for a given layer, each neuron has a connection to every neuron in the next layer. This is depicted with two neurons in the input layer: the remaining connections are omitted for clarity. The model is thus designed to take in values of 10 indicators for a given week, and predict the values of the 6 sector ETFs for that week.

## Results

#### Figure 4 | Learning Curves
<div>
    <a href="https://plot.ly/~Kennfucius/60/?share_key=HDy62nv8nvdFmjiQBBUwI5" target="_blank" title="sectorETF-learningcurves" style="display: block; text-align: center;"><img src="https://plot.ly/~Kennfucius/60.png?share_key=HDy62nv8nvdFmjiQBBUwI5" alt="sectorETF-learningcurves" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="Kennfucius:60" sharekey-plotly="HDy62nv8nvdFmjiQBBUwI5" src="https://plot.ly/embed.js" async></script>
</div>

#### Figure 5 | Predicted vs Actual Values
<div>
    <a href="https://plot.ly/~Kennfucius/64/?share_key=smVViU65PW6qFLClDJEcm5" target="_blank" title="predictions-0" style="display: block; text-align: center;"><img src="https://plot.ly/~Kennfucius/64.png?share_key=smVViU65PW6qFLClDJEcm5" alt="predictions-0" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="Kennfucius:64" sharekey-plotly="smVViU65PW6qFLClDJEcm5" src="https://plot.ly/embed.js" async></script>
</div>

## Deep Diving
