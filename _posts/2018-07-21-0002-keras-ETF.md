---
title: "Stock Market Forecasting With a Simple Neural Network"
date: 2018-07-21
tags: [regression, analysis, neural network, stock market]
header:
  overlay_image: "/images/0002-keras-ETF/0002-banner1-small.jpg"
  overlay_filter: 0.5
  teaser: "/images/0002-keras-ETF/0002-banner3.jpg"
excerpt: "Forecasting U.S. Sector ETFs using economic indicators"
mathjax: "true"
# This sets the table of contents on the right of the page
toc: true
toc_label: "Table of Contents"
toc_icon: "trending_up"
toc_sticky: "true"
---

## Objective
I created a simple neural network (NN) using the [Keras](https://keras.io/) python library. The NN was used to predict future exchange traded fund (ETF) prices using economic indicators as features.

## Background

> Note: All visualizations are interactive and were generated using [plotly](https://plot.ly/python/).

#### Figure 1 | Sector ETF Time Series
<div>
    <a href="https://plot.ly/~Kennfucius/58/?share_key=QV8H0WketK0rEs65vyTTrW" target="_blank" title="sector-ETFs" style="display: block; text-align: center;"><img src="https://plot.ly/~Kennfucius/58.png?share_key=QV8H0WketK0rEs65vyTTrW" alt="sector-ETFs" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="Kennfucius:58" sharekey-plotly="QV8H0WketK0rEs65vyTTrW" src="https://plot.ly/embed.js" async></script>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Data for six U.S. sector ETFs dating back to May 2000, was obtained from yahoo finance. Sector ETFs tend to experience significantly less volatility than their individual underlying assets. This makes them attractive for forecasting.

1. Technology ([IYW](https://finance.yahoo.com/quote/IYW))
2. Basic Materials ([IYM](https://finance.yahoo.com/quote/IYM))
3. Consumer Goods ([IYK](https://finance.yahoo.com/quote/IYK))
4. Services ([IYC](https://finance.yahoo.com/quote/IYC))
5. Healthcare ([IYH](https://finance.yahoo.com/quote/IYH))
6. Utilities ([IDU](https://finance.yahoo.com/quote/IDU))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The economic indicators

## Data Munging

#### Figure 2 | Normalized Sector ETFs
<div>
    <a href="https://plot.ly/~Kennfucius/56/?share_key=EEcDEAUTyHEnRhmziudPS0" target="_blank" title="norm-sector-ETFs" style="display: block; text-align: center;"><img src="https://plot.ly/~Kennfucius/56.png?share_key=EEcDEAUTyHEnRhmziudPS0" alt="norm-sector-ETFs" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="Kennfucius:56" sharekey-plotly="EEcDEAUTyHEnRhmziudPS0" src="https://plot.ly/embed.js" async></script>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;


<details>
  <summary>Expand for a list of the economic indicators used. </summary>
  <p>

* list
1. PAYEMS  | Non Farm Payroll
2. PAYNSA  | Non Farm Payroll NSA
3. Blah | something

| table |
| ----  |
| Values  |

</p></details>

## Training the Model

#### Figure 3 | Learning Curves
<div>
    <a href="https://plot.ly/~Kennfucius/60/?share_key=HDy62nv8nvdFmjiQBBUwI5" target="_blank" title="sectorETF-learningcurves" style="display: block; text-align: center;"><img src="https://plot.ly/~Kennfucius/60.png?share_key=HDy62nv8nvdFmjiQBBUwI5" alt="sectorETF-learningcurves" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="Kennfucius:60" sharekey-plotly="HDy62nv8nvdFmjiQBBUwI5" src="https://plot.ly/embed.js" async></script>
</div>

#### Figure 4 | Predicted vs Actual Values
<div>
    <a href="https://plot.ly/~Kennfucius/64/?share_key=smVViU65PW6qFLClDJEcm5" target="_blank" title="predictions-0" style="display: block; text-align: center;"><img src="https://plot.ly/~Kennfucius/64.png?share_key=smVViU65PW6qFLClDJEcm5" alt="predictions-0" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="Kennfucius:64" sharekey-plotly="smVViU65PW6qFLClDJEcm5" src="https://plot.ly/embed.js" async></script>
</div>

## Deep Diving
